# PR Reviewer Assignment Service (Fall 2025)

Сервис назначения ревьюеров для PR, реализован на Go с PostgreSQL и Docker Compose.  
Все настройки вынесены в `config.yaml`. Реализованы clean architecture, graceful shutdown и миграции через `golang-migrate`.


## Быстрый старт

❕Убедитесь, что Docker Engine запущен и порты `:8080` и `:5432` свободны.

### Запуск через Make
```bash
make up       # поднять сервис и БД
make logs     # смотреть логи приложения
make down     # остановить сервис
make ps       # проверить статус контейнеров
```

### Запуск через Make
```bash
docker compose up -d --build
docker compose logs -f app
docker compose down
```

После запуска сервис доступен на http://localhost:8080.



## Конфигурация

- Все настройки приложения вынесены в файл `config.yaml`.
- ID пользователей и PR обрабатываются как строки, а не UUID, чтобы поддерживать формат, приходящий от клиентов.
- Миграции выполняются через `golang-migrate`.
- Все валидные эндпоинты документированы в `openapi.yaml`.
- Порт приложения по умолчанию: `8080`.
- Порт базы данных PostgreSQL по умолчанию: `5432`.


## Особенности использования

- В отличие от изначальной реализации, эндпоинт `/team/add` возвращает **409 Conflict** вместо **400 Bad Request** при ошибках:
  - `TEAM_EXISTS` — команда с таким именем уже существует.
  - `USER_IN_ANOTHER_TEAM` — пользователь уже находится в другой команде.
- Исправлена ошибка в OpenAPI: в примере `/pullRequest/reassign`, неверное поле `old_reviewer_id` было заменено на `old_user_id`.
- Merge PR идемпотентен.
- Пользователь может находиться только в одной команде одновременно.
- Добавлен **graceful shutdown**.
- Поле env в config.yaml ("dev" или "prod") определяет стиль логов и уровень логера.
- Все настройки по умолчанию можно изменить через `config.yaml`.



## ТЗ

### Основные требования
- Были выполнены все основные требования

### Дополнительные задания 
- Реализован простой эндпоинт статистики `/users/getReview`, который возвращает все PR, назначенные конкретному пользователю.


